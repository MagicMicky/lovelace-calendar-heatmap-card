var e=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50"],t={title:"Game Activity",days_to_show:365,ignored_states:["unknown","idle","offline",""],refresh_interval:300,theme:"dark",start_day_of_week:"monday"};function n(e,t,n,i,a,o,r){try{var s=e[o](r),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,a)}function i(e){return function(){var t=this,i=arguments;return new Promise((function(a,o){var r=e.apply(t,i);function s(e){n(r,a,o,s,l,"next",e)}function l(e){n(r,a,o,s,l,"throw",e)}s(void 0)}))}}function a(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const l=window,c=l.ShadowRoot&&(void 0===l.ShadyCSS||l.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,d=Symbol(),h=new WeakMap;let p=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==d)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(c&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=h.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&h.set(t,e))}return e}toString(){return this.cssText}};const u=c?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return(e=>new p("string"==typeof e?e:e+"",void 0,d))(t)})(e):e;var m;const g=window,v=g.trustedTypes,f=v?v.emptyScript:"",_=g.reactiveElementPolyfillSupport,y={toAttribute(e,t){switch(t){case Boolean:e=e?f:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},b=(e,t)=>t!==e&&(t==t||e==e),w={attribute:!0,type:String,converter:y,reflect:!1,hasChanged:b},x="finalized";let C=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const i=this._$Ep(n,t);void 0!==i&&(this._$Ev.set(i,n),e.push(i))})),e}static createProperty(e,t=w){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,n,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||w}static finalize(){if(this.hasOwnProperty(x))return!1;this[x]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(u(e))}else void 0!==e&&t.push(u(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{c?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const n=document.createElement("style"),i=l.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=t.cssText,e.appendChild(n)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=w){var i;const a=this.constructor._$Ep(e,n);if(void 0!==a&&!0===n.reflect){const o=(void 0!==(null===(i=n.converter)||void 0===i?void 0:i.toAttribute)?n.converter:y).toAttribute(t,n.type);this._$El=e,null==o?this.removeAttribute(a):this.setAttribute(a,o),this._$El=null}}_$AK(e,t){var n;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),o="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:y;this._$El=a,this[a]=o.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let i=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||b)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};var $;C[x]=!0,C.elementProperties=new Map,C.elementStyles=[],C.shadowRootOptions={mode:"open"},null==_||_({ReactiveElement:C}),(null!==(m=g.reactiveElementVersions)&&void 0!==m?m:g.reactiveElementVersions=[]).push("1.6.3");const A=window,S=A.trustedTypes,E=S?S.createPolicy("lit-html",{createHTML:e=>e}):void 0,k="$lit$",H=`lit$${(Math.random()+"").slice(9)}$`,D="?"+H,N=`<${D}>`,O=document,T=()=>O.createComment(""),P=e=>null===e||"object"!=typeof e&&"function"!=typeof e,M=Array.isArray,j="[ \t\n\f\r]",U=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,I=/-->/g,R=/>/g,z=RegExp(`>|${j}(?:([^\\s"'>=/]+)(${j}*=${j}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),L=/'/g,V=/"/g,W=/^(?:script|style|textarea|title)$/i,B=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),F=Symbol.for("lit-noChange"),G=Symbol.for("lit-nothing"),q=new WeakMap,J=O.createTreeWalker(O,129,null,!1);function K(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==E?E.createHTML(t):t}const Z=(e,t)=>{const n=e.length-1,i=[];let a,o=2===t?"<svg>":"",r=U;for(let t=0;t<n;t++){const n=e[t];let s,l,c=-1,d=0;for(;d<n.length&&(r.lastIndex=d,l=r.exec(n),null!==l);)d=r.lastIndex,r===U?"!--"===l[1]?r=I:void 0!==l[1]?r=R:void 0!==l[2]?(W.test(l[2])&&(a=RegExp("</"+l[2],"g")),r=z):void 0!==l[3]&&(r=z):r===z?">"===l[0]?(r=null!=a?a:U,c=-1):void 0===l[1]?c=-2:(c=r.lastIndex-l[2].length,s=l[1],r=void 0===l[3]?z:'"'===l[3]?V:L):r===V||r===L?r=z:r===I||r===R?r=U:(r=z,a=void 0);const h=r===z&&e[t+1].startsWith("/>")?" ":"";o+=r===U?n+N:c>=0?(i.push(s),n.slice(0,c)+k+n.slice(c)+H+h):n+H+(-2===c?(i.push(void 0),t):h)}return[K(e,o+(e[n]||"<?>")+(2===t?"</svg>":"")),i]};class Y{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let a=0,o=0;const r=e.length-1,s=this.parts,[l,c]=Z(e,t);if(this.el=Y.createElement(l,n),J.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=J.nextNode())&&s.length<r;){if(1===i.nodeType){if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith(k)||t.startsWith(H)){const n=c[o++];if(e.push(t),void 0!==n){const e=i.getAttribute(n.toLowerCase()+k).split(H),t=/([.?@])?(.*)/.exec(n);s.push({type:1,index:a,name:t[2],strings:e,ctor:"."===t[1]?ne:"?"===t[1]?ae:"@"===t[1]?oe:te})}else s.push({type:6,index:a})}for(const t of e)i.removeAttribute(t)}if(W.test(i.tagName)){const e=i.textContent.split(H),t=e.length-1;if(t>0){i.textContent=S?S.emptyScript:"";for(let n=0;n<t;n++)i.append(e[n],T()),J.nextNode(),s.push({type:2,index:++a});i.append(e[t],T())}}}else if(8===i.nodeType)if(i.data===D)s.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(H,e+1));)s.push({type:7,index:a}),e+=H.length-1}a++}}static createElement(e,t){const n=O.createElement("template");return n.innerHTML=e,n}}function Q(e,t,n=e,i){var a,o,r,s;if(t===F)return t;let l=void 0!==i?null===(a=n._$Co)||void 0===a?void 0:a[i]:n._$Cl;const c=P(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(o=null==l?void 0:l._$AO)||void 0===o||o.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,n,i)),void 0!==i?(null!==(r=(s=n)._$Co)&&void 0!==r?r:s._$Co=[])[i]=l:n._$Cl=l),void 0!==l&&(t=Q(e,l._$AS(e,t.values),l,i)),t}class X{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:n},parts:i}=this._$AD,a=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:O).importNode(n,!0);J.currentNode=a;let o=J.nextNode(),r=0,s=0,l=i[0];for(;void 0!==l;){if(r===l.index){let t;2===l.type?t=new ee(o,o.nextSibling,this,e):1===l.type?t=new l.ctor(o,l.name,l.strings,this,e):6===l.type&&(t=new re(o,this,e)),this._$AV.push(t),l=i[++s]}r!==(null==l?void 0:l.index)&&(o=J.nextNode(),r++)}return J.currentNode=O,a}v(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class ee{constructor(e,t,n,i){var a;this.type=2,this._$AH=G,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cp=null===(a=null==i?void 0:i.isConnected)||void 0===a||a}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Q(this,e,t),P(e)?e===G||null==e||""===e?(this._$AH!==G&&this._$AR(),this._$AH=G):e!==this._$AH&&e!==F&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):(e=>M(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==G&&P(this._$AH)?this._$AA.nextSibling.data=e:this.$(O.createTextNode(e)),this._$AH=e}g(e){var t;const{values:n,_$litType$:i}=e,a="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=Y.createElement(K(i.h,i.h[0]),this.options)),i);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===a)this._$AH.v(n);else{const e=new X(a,this),t=e.u(this.options);e.v(n),this.$(t),this._$AH=e}}_$AC(e){let t=q.get(e.strings);return void 0===t&&q.set(e.strings,t=new Y(e)),t}T(e){M(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const a of e)i===t.length?t.push(n=new ee(this.k(T()),this.k(T()),this,this.options)):n=t[i],n._$AI(a),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class te{constructor(e,t,n,i,a){this.type=1,this._$AH=G,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=G}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,n,i){const a=this.strings;let o=!1;if(void 0===a)e=Q(this,e,t,0),o=!P(e)||e!==this._$AH&&e!==F,o&&(this._$AH=e);else{const i=e;let r,s;for(e=a[0],r=0;r<a.length-1;r++)s=Q(this,i[n+r],t,r),s===F&&(s=this._$AH[r]),o||(o=!P(s)||s!==this._$AH[r]),s===G?e=G:e!==G&&(e+=(null!=s?s:"")+a[r+1]),this._$AH[r]=s}o&&!i&&this.j(e)}j(e){e===G?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class ne extends te{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===G?void 0:e}}const ie=S?S.emptyScript:"";class ae extends te{constructor(){super(...arguments),this.type=4}j(e){e&&e!==G?this.element.setAttribute(this.name,ie):this.element.removeAttribute(this.name)}}class oe extends te{constructor(e,t,n,i,a){super(e,t,n,i,a),this.type=5}_$AI(e,t=this){var n;if((e=null!==(n=Q(this,e,t,0))&&void 0!==n?n:G)===F)return;const i=this._$AH,a=e===G&&i!==G||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==G&&(i===G||a);a&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$AH.handleEvent(e)}}class re{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Q(this,e)}}const se=A.litHtmlPolyfillSupport;null==se||se(Y,ee),(null!==($=A.litHtmlVersions)&&void 0!==$?$:A.litHtmlVersions=[]).push("2.8.0");var le,ce;class de extends C{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const n=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=n.firstChild),n}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{var i,a;const o=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:t;let r=o._$litPart$;if(void 0===r){const e=null!==(a=null==n?void 0:n.renderBefore)&&void 0!==a?a:null;o._$litPart$=r=new ee(t.insertBefore(T(),e),e,void 0,null!=n?n:{})}return r._$AI(e),r})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return F}}de.finalized=!0,de._$litElement$=!0,null===(le=globalThis.litElementHydrateSupport)||void 0===le||le.call(globalThis,{LitElement:de});const he=globalThis.litElementPolyfillSupport;function pe(){return(pe=i((function*(e,t,n){if(!e)return console.warn("Calendar Heatmap: Invalid Home Assistant instance"),[];if(!t||"string"!=typeof t)return console.warn("Calendar Heatmap: Invalid entity ID"),[];(!n||n<=0)&&(console.warn("Calendar Heatmap: Invalid days to show, using default of 30 days"),n=30),console.log("Calendar Heatmap: Fetching history for",t,"for",n,"days");var i=new Date,a=new Date(i.getTime()-24*n*60*60*1e3);if(e.callWS)try{console.log("Calendar Heatmap: Using WebSocket API");var o=yield e.callWS({type:"history/history_during_period",entity_ids:[t],start_time:a.toISOString(),end_time:i.toISOString(),minimal_response:!1,no_attributes:!0,significant_changes_only:!1});if(console.log("Calendar Heatmap: WebSocket response",o),o&&o[t]&&Array.isArray(o[t])){console.log("Calendar Heatmap: Valid WebSocket response with",o[t].length,"entries");var r=o[t][0];return!r||void 0===r.s&&void 0===r.lu||console.log("Calendar Heatmap: Detected compressed history format, using as is"),[o[t]]}console.warn("Calendar Heatmap: Unexpected WebSocket response format, falling back to REST API")}catch(e){console.error("Calendar Heatmap: Error fetching history data via WebSocket",e)}if(e.callApi)try{console.log("Calendar Heatmap: Using REST API");var s=a.toISOString(),l=i.toISOString(),c=encodeURIComponent(t),d=encodeURIComponent(l),h="history/period/".concat(s,"?filter_entity_id=").concat(c,"&end_time=").concat(d),p=yield e.callApi("GET",h);if(console.log("Calendar Heatmap: REST API response",p),Array.isArray(p)&&p.length>0){if(Array.isArray(p[0]))return console.log("Calendar Heatmap: Valid REST API response with",p[0].length,"entries"),p;console.warn("Calendar Heatmap: Unexpected REST API response format")}else console.warn("Calendar Heatmap: Empty or invalid history response")}catch(e){console.error("Calendar Heatmap: Error fetching history data via REST API",e)}else console.warn("Calendar Heatmap: No API methods available on hass object");return console.warn("Calendar Heatmap: Failed to fetch history data"),[]}))).apply(this,arguments)}function ue(){return(ue=i((function*(e,t,n){if(!e||!e.connection)return console.warn("Calendar Heatmap: Invalid Home Assistant instance or no connection available"),()=>{};if(!t||"string"!=typeof t)return console.warn("Calendar Heatmap: Invalid entity ID"),()=>{};if(!n||"function"!=typeof n)return console.warn("Calendar Heatmap: Invalid callback function"),()=>{};try{console.log("Calendar Heatmap: Subscribing to entity ".concat(t));var i=yield e.connection.subscribeEvents((e=>{e.data&&e.data.entity_id===t&&(console.log("Calendar Heatmap: Received state change for ".concat(t),e.data),n(e.data))}),"state_changed");return console.log("Calendar Heatmap: Successfully subscribed to ".concat(t)),i}catch(e){return console.error("Calendar Heatmap: Error subscribing to entity",e),()=>{}}}))).apply(this,arguments)}function me(t){var n=new Set;for(var i in t)for(var a in t[i])n.add(a);var o={};return Array.from(n).forEach((t=>{o[t]=function(t){if(!t||"string"!=typeof t)return e[0];for(var n=0,i=0;i<t.length;i++)n=t.charCodeAt(i)+((n<<5)-n);return n=Math.abs(n),e[n%e.length]}(t)})),o}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=document.createElement(e);return Object.entries(t).forEach((e=>{var[t,n]=e;i.style[t]=n})),Object.entries(n).forEach((e=>{var[t,n]=e;i[t]=n})),i}null==he||he({LitElement:de}),(null!==(ce=globalThis.litElementVersions)&&void 0!==ce?ce:globalThis.litElementVersions=[]).push("3.3.3");var ve,fe,_e,ye={cellWidth:14,cellMargin:3,get weekColWidth(){return this.cellWidth+this.cellMargin}};function be(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"monday",n=ge("div",{},{className:"day-labels day-label-spacing"}),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"monday",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=[],i=new Date(2e3,0,2);"monday"===e&&i.setDate(3);for(var a=0;a<7;a++)n.push(i.toLocaleString(t,{weekday:"short"})),i.setDate(i.getDate()+1);return n}(t),a=[0,2,4],o=0;o<7;o++){var r=ge("div",{},{className:"day-label"});a.includes(o)?r.textContent=i[o]:r.textContent="",n.appendChild(r)}return n}function we(e){if(e<60)return"".concat(Math.round(e)," sec");var t=Math.floor(e/3600),n=Math.round(e%3600/60),i="";return t>0&&(i+="".concat(t,"h")),n>0&&(i+=" ".concat(n,"m")),i.trim()}function xe(e,t,n,i,a,o,r,s){var{cellWidth:l,cellMargin:c,weekColWidth:d}=ye,h=ge("div",{},{className:"heatmap-grid",style:"min-width: ".concat(e.length*d,"px;")});return e.forEach(((l,c)=>{for(var d=ge("div",{},{className:"week-column week-column-spacing"}),p=function(){var h;if(u<l.length){var p=l[u],m=p.toISOString().split("T")[0],g=t[m]||{},v=Object.values(g).reduce(((e,t)=>e+t),0),{dominantGame:f,dominantSec:_}=function(e){var t="",n=0;for(var[i,a]of Object.entries(e))a>n&&(n=a,t=i);return{dominantGame:t,dominantSec:n}}(g),y="dark"===a?"#757575":"#E0E0E0",b=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"dark";if(!e||"string"!=typeof e)return"dark"===n?"rgb(0, 0, 0)":"rgb(255, 255, 255)";var i,a,o,r=Math.max(0,Math.min(1,t)),s=e.startsWith("#")?e.slice(1):e;try{if(i=parseInt(s.slice(0,2),16),a=parseInt(s.slice(2,4),16),o=parseInt(s.slice(4,6),16),isNaN(i)||isNaN(a)||isNaN(o))throw new Error("Invalid hex color")}catch(t){return console.warn("Invalid hex color: ".concat(e,". Using fallback.")),"dark"===n?"rgb(80, 80, 80)":"rgb(200, 200, 200)"}var l="dark"===n?0:255;return i=Math.round(l*(1-r)+i*r),a=Math.round(l*(1-r)+a*r),o=Math.round(l*(1-r)+o*r),"rgb(".concat(i,", ").concat(a,", ").concat(o,")")}(f?i[f]:y,n>0?_/n:0,a),w=["day-cell","position-relative"];s===m&&w.push("selected"),0===u&&w.push("first-in-row"),6===u&&w.push("last-in-row"),0===c&&w.push("first-in-column"),c===e.length-1&&w.push("last-in-column"),(h=ge("div",{},{className:w.join(" "),style:"background-color: ".concat(b,";"),title:"".concat(p.toLocaleDateString()," - ").concat(v>0?we(v):"No activity")}))._data={date:m,statesObj:g,gameColorMap:i},o&&(h.addEventListener("mouseenter",(()=>{o(h._data)})),h.addEventListener("mouseleave",(()=>{o(null)}))),r&&h.addEventListener("click",(()=>{r(h._data)}))}else h=ge("div",{},{className:"empty-cell"});d.appendChild(h)},u=0;u<7;u++)p();h.appendChild(d)})),h}function Ce(e,t,n){var i=ge("div",{},{className:"breakdown-item"}),a=ge("div",{},{className:"color-swatch",style:"background: ".concat(n,";")}),o=ge("div",{},{className:"game-name",textContent:e}),r=ge("div",{},{textContent:we(t)});return i.appendChild(a),i.appendChild(o),i.appendChild(r),i}function $e(e,t){e.innerHTML="";var n=ge("div",{},{className:"content-container"}),i=ge("h2",{},{textContent:new Date(t.date).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),a=Object.values(t.statesObj).reduce(((e,t)=>e+t),0),o=ge("div",{},{className:"total-element",textContent:"Total: ".concat(we(a))}),r=ge("h3",{},{textContent:"Breakdown"}),s=ge("div",{},{className:"breakdown-container"});n.appendChild(i),n.appendChild(o),n.appendChild(r),n.appendChild(s);for(var l=Object.entries(t.statesObj).sort(((e,t)=>t[1]-e[1])),c=Math.min(l.length,5),d=0;d<c;d++){var[h,p]=l[d],u=Ce(h,p,t.gameColorMap[h]);s.appendChild(u)}if(l.length>c){var m=ge("div",{},{className:"breakdown-item",textContent:"+ ".concat(l.length-c," more..."),style:"opacity: 0.7; font-style: italic; margin-top: 4px;"});s.appendChild(m)}e.appendChild(n)}console.info("%c CALENDAR-HEATMAP-CARD %c ".concat("3.1.1"," "),"color: white; background: #3498db; font-weight: 700;","color: #3498db; background: white; font-weight: 700;"),customElements.define("calendar-heatmap-card",class extends de{static get properties(){return{_config:{type:Object},_hass:{type:Object},_selectedDate:{type:String},_dailyTotals:{type:Object},_gameColorMap:{type:Object},_maxValue:{type:Number},_overallTotals:{type:Object},_bestGame:{type:String},_bestSec:{type:Number}}}static get styles(){return((e,...t)=>{const n=1===e.length?e[0]:t.reduce(((t,n,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[i+1]),e[0]);return new p(n,e,d)})(ve||(ve=s(["\n      :host {\n        display: block;\n      }\n      /* Styles will be loaded dynamically based on theme */\n    "])))}constructor(){super(),this._hasConnected=!1,this._unsubscribe=null,this._selectedDate=null,this._dailyTotals={},this._gameColorMap={},this._maxValue=0,this._overallTotals={},this._bestGame="",this._bestSec=0,this._lastEntityState=null,this._lastHistoryTimestamp=0}setConfig(e){if(!e.entity)throw new Error("You need to define an entity in your card configuration.");this._config=r(r({},t),e),!0===this._config.include_unknown&&this._config.ignored_states.includes("unknown")&&(this._config.ignored_states=this._config.ignored_states.filter((e=>"unknown"!==e)),console.log("Calendar Heatmap: Including unknown states, ignored states are now:",this._config.ignored_states))}set hass(e){var t=this._hass;this._hass=e,t&&this._hasConnected||(this._fetchData(),this._hasConnected&&this._setupSubscription())}getCardSize(){return 6}connectedCallback(){super.connectedCallback(),this._hasConnected?this._setupSubscription():(this._hasConnected=!0,this._fetchData().then((()=>{this.shadowRoot&&(this.shadowRoot.querySelector(".detail-view")&&this._updateDetailView(this._selectedDate||null));this._setupSubscription()})))}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeFromEntity()}_setupSubscription(){var e=this;return i((function*(){if(e._unsubscribeFromEntity(),e._hass&&e._config&&e._config.entity)try{e._unsubscribe=yield function(e,t,n){return ue.apply(this,arguments)}(e._hass,e._config.entity,(t=>{console.log("Calendar Heatmap: Entity state changed, updating data"),t.new_state&&(e._lastEntityState=t.new_state.state),setTimeout((()=>{e._fetchData()}),2e3)})),console.log("Calendar Heatmap: Subscription set up successfully")}catch(e){console.error("Calendar Heatmap: Error setting up subscription",e)}else console.warn("Calendar Heatmap: Cannot set up subscription - missing hass, config, or entity")}))()}_unsubscribeFromEntity(){if(this._unsubscribe&&"function"==typeof this._unsubscribe){try{this._unsubscribe(),console.log("Calendar Heatmap: Unsubscribed from entity state changes")}catch(e){console.error("Calendar Heatmap: Error unsubscribing from entity",e)}this._unsubscribe=null}}_fetchData(){var e=this;return i((function*(){if(!e._hass||!e._config)return console.warn("Calendar Heatmap: No hass or config available"),Promise.resolve();var n=e._config.entity,i=e._config.days_to_show||t.days_to_show;console.log("Calendar Heatmap: Fetching data for",n,"with config:",e._config);try{var a=yield function(e,t,n){return pe.apply(this,arguments)}(e._hass,n,i);if(!a||0===a.length||!a[0]||0===a[0].length)return console.warn("Calendar Heatmap: No history data returned for",n),Promise.resolve();console.log("Calendar Heatmap: Successfully fetched history with",a[0].length,"entries");var o=e._config.ignored_states||t.ignored_states;console.log("Calendar Heatmap: Using ignored states:",o);var r=function(e,t){if(console.log("Calendar Heatmap: Processing history data",e),console.log("Calendar Heatmap: Ignored states",t),e&&e[0]&&e[0].length>0){console.log("Calendar Heatmap: First 5 raw history entries:");for(var n=0;n<Math.min(5,e[0].length);n++)console.log("Entry ".concat(n,":"),JSON.stringify(e[0][n]))}var i={},a=0,o=0;if(e&&e[0]){var r=e[0];console.log("Calendar Heatmap: Entity history length",r.length);for(var s=0;s<r.length-1;s++){var l=r[s],c=r[s+1],d=(null==l?void 0:l.state)||(null==l?void 0:l.s),h=(null==l?void 0:l.last_changed)||(null!=l&&l.lu?new Date(1e3*l.lu).toISOString():null),p=(null==c?void 0:c.last_changed)||(null!=c&&c.lu?new Date(1e3*c.lu).toISOString():null);if(d&&p){var u=d.toLowerCase();if(s<5&&console.log("Calendar Heatmap: Entry",s,"state:",d,"last_changed:",h),t.includes(u))console.log("Calendar Heatmap: Skipping entry ".concat(s,' - state "').concat(d,'" is in ignored_states list')),a++;else if(h){var m=new Date(h),g=new Date(p);if(isNaN(m.getTime())||isNaN(g.getTime()))console.log("Calendar Heatmap: Skipping entry ".concat(s," - invalid date format")),a++;else{var v=(g-m)/1e3;if(v<=0||v>86400)console.log("Calendar Heatmap: Skipping entry ".concat(s," - invalid time difference: ").concat(v," seconds")),a++;else{var f=m.toISOString().split("T")[0];i[f]||(i[f]={}),i[f][d]=(i[f][d]||0)+v,o++}}}else console.log("Calendar Heatmap: Skipping entry ".concat(s," - missing last_changed")),a++}else console.log("Calendar Heatmap: Skipping entry ".concat(s," - missing required properties")),console.log("Current state:",d),console.log("Next last_changed:",p),a++}}return console.log("Calendar Heatmap: Processed entries",o),console.log("Calendar Heatmap: Skipped entries",a),console.log("Calendar Heatmap: Daily totals",i),i}(a,o);if(0===Object.keys(r).length)return console.warn("Calendar Heatmap: No daily totals generated. Check if all states are being filtered out."),Promise.resolve();e._dailyTotals=r,e._maxValue=function(e){var t=0;for(var n in e){var i=e[n],a=Object.values(i).reduce(((e,t)=>e+t),0);a>t&&(t=a)}return t}(r),e._gameColorMap=me(r),e._overallTotals=function(e){var t={};for(var n in e)for(var i in e[n])t[i]=(t[i]||0)+e[n][i];return t}(r);var{bestGame:s,bestSec:l}=function(e){var t="",n=0;for(var i in e)e[i]>n&&(n=e[i],t=i);return{bestGame:t,bestSec:n}}(e._overallTotals);return e._bestGame=s,e._bestSec=l,console.log("Calendar Heatmap: Data processing complete",{dailyTotals:e._dailyTotals,maxValue:e._maxValue,gameColorMap:e._gameColorMap,overallTotals:e._overallTotals,bestGame:e._bestGame,bestSec:e._bestSec}),e.requestUpdate(),Promise.resolve()}catch(e){return console.error("Calendar Heatmap: Error fetching or processing data",e),Promise.reject(e)}}))()}_createSummaryData(){return{overallTotals:this._overallTotals,gameColorMap:this._gameColorMap,bestGame:this._bestGame,bestSec:this._bestSec}}_createDayData(e){return{date:e,statesObj:this._dailyTotals[e]||{},gameColorMap:this._gameColorMap}}_updateDetailView(e){var t=this.shadowRoot.querySelector(".detail-view");t&&(e?$e(t,this._createDayData(e)):function(e,t){e.innerHTML="";var n=ge("div",{},{className:"content-container"}),i=ge("h2",{},{textContent:"Overall Summary"}),a=Object.values(t.overallTotals).reduce(((e,t)=>e+t),0),o=ge("div",{},{className:"total-element",textContent:"Total: ".concat(we(a))}),r=ge("h3",{},{textContent:"Breakdown"}),s=ge("div",{},{className:"breakdown-container"});n.appendChild(i),n.appendChild(o),n.appendChild(r),n.appendChild(s);for(var l=Object.entries(t.overallTotals).sort(((e,t)=>t[1]-e[1])),c=Math.min(l.length,4),d=0;d<c;d++){var[h,p]=l[d],u=Ce(h,p,t.gameColorMap[h]);s.appendChild(u)}if(l.length>c){var m=ge("div",{},{className:"breakdown-item",textContent:"+ ".concat(l.length-c," more..."),style:"opacity: 0.7; font-style: italic; margin-top: 4px;"});s.appendChild(m)}e.appendChild(n)}(t,this._createSummaryData()))}_onCellHover(e){var t=this.shadowRoot.querySelector(".detail-view");t&&(e?$e(t,e):this._selectedDate?this._updateDetailView(this._selectedDate):this._updateDetailView(null))}_onCellClick(e){this._selectedDate===e.date?(this._selectedDate=null,this._updateDetailView(null)):(this._selectedDate=e.date,this._updateDetailView(e.date)),this._updateSelectedCellClasses(),this.requestUpdate()}_updateSelectedCellClasses(){var e=this.shadowRoot.querySelector(".heatmap-grid");if(e){var t=e.querySelectorAll(".day-cell");if(t.forEach((e=>{e.classList.remove("selected")})),this._selectedDate){var n=Array.from(t).find((e=>e._data&&e._data.date===this._selectedDate));n&&n.classList.add("selected")}}}render(){if(!this._config||!this._hass)return B(fe||(fe=s([""])));var e,t,n,i,a=(e=this._config.theme,n="light"===e?"#888":"#8b949e",i="light"===e?"#E0E0E0":"#757575","\n    :host {\n      --heatmap-primary-text: ".concat(t="light"===e?"#333":"#c9d1d9",";\n      --heatmap-secondary-text: ").concat(n,";\n      --heatmap-no-data-color: ").concat(i,";\n      --heatmap-cell-width: ").concat(ye.cellWidth,"px;\n      --heatmap-cell-margin: ").concat(ye.cellMargin,"px;\n      --heatmap-week-col-width: ").concat(ye.weekColWidth,"px;\n    }\n    \n    /* Card Container */\n    ha-card {\n      box-shadow: var(--ha-card-box-shadow, 0 2px 5px rgba(0,0,0,0.26));\n      border-radius: var(--ha-card-border-radius, 4px);\n      color: var(--primary-text-color, ").concat(t,");\n      overflow: hidden;\n      position: relative;\n      padding: 0;\n    }\n    \n    .card-content {\n      font-family: var(--paper-font-common-base, sans-serif);\n      display: flex;\n      flex-wrap: wrap;\n      padding: 0;\n      height: auto;\n      min-height: 220px;\n    }\n    \n    /* Layout Containers */\n    .heatmap-container {\n      flex: 3;\n      min-width: 0;\n      padding: 16px 16px 24px 16px;\n      background-color: var(--ha-card-background);\n      min-height: 220px;\n      overflow: hidden;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n    }\n    \n    .detail-view {\n      flex: 1;\n      min-width: 200px;\n      max-width: 280px;\n      padding: 16px 16px 16px 12px;\n      background-color: var(--secondary-background-color, #f7f7f7);\n      border-left: 1px solid var(--divider-color, #CCC);\n      display: flex;\n      flex-direction: column;\n      overflow: hidden;\n      opacity: 0.9;\n      min-height: 220px;\n      height: 100%;\n    }\n    \n    /* Headers */\n    .card-header {\n      padding: 8px 0 16px;\n      font-size: 1.4em;\n      font-weight: 500;\n      color: var(--primary-text-color, ").concat(t,");\n      position: sticky;\n      left: 0;\n      background-color: var(--ha-card-background);\n      z-index: 1;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      margin-bottom: 4px;\n    }\n    \n    .detail-header {\n      font-size: 0.9em;\n      font-weight: 500;\n      margin-bottom: 8px;\n      opacity: 0.7;\n      text-transform: uppercase;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    .detail-view h2 {\n      margin-top: 0;\n      margin-bottom: 8px;\n      font-size: 1em;\n      opacity: 0.9;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    .detail-view h3 {\n      margin: 8px 0 4px;\n      margin-bottom: 8px;\n      margin-top: 0;\n      font-size: 0.9em;\n      opacity: 0.8;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    /* Month Header */\n    .month-header {\n      display: flex;\n      margin-left: 36px;\n      margin-bottom: 4px;\n      font-size: 0.8em;\n      font-weight: 500;\n      color: var(--heatmap-primary-text);\n      position: sticky;\n      left: 36px;\n      background-color: var(--ha-card-background);\n      z-index: 1;\n      white-space: nowrap;\n      padding-left: 3px;\n    }\n    \n    .month-label {\n      text-align: center;\n      display: inline-block;\n      overflow: hidden;\n      box-sizing: border-box;\n    }\n    \n    /* Day Labels */\n    .day-labels {\n      display: flex;\n      flex-direction: column;\n      margin-right: 4px;\n      font-size: 0.75em;\n      color: var(--heatmap-secondary-text);\n      position: sticky;\n      left: 0;\n      z-index: 2;\n      background-color: var(--ha-card-background);\n      width: 32px;\n      text-align: right;\n      padding-top: 6px;\n      box-sizing: border-box;\n      margin-top: 0;\n      margin-bottom: 0;\n    }\n    \n    .day-label {\n      height: ").concat(ye.cellWidth,"px;\n      margin-bottom: ").concat(ye.cellMargin,"px;\n      padding-right: 4px;\n      display: flex;\n      align-items: center;\n      justify-content: flex-end;\n      box-sizing: border-box;\n    }\n    \n    /* Grid Components */\n    .grid-container {\n      display: flex;\n      min-width: min-content;\n      overflow: visible;\n      margin-top: 0;\n      flex: 1;\n      align-items: flex-start;\n      position: relative;\n      box-sizing: border-box;\n      margin-left: 0;\n      margin-right: 0;\n      padding: 0;\n    }\n    \n    .heatmap-grid {\n      display: flex;\n      flex-wrap: nowrap;\n      min-width: min-content;\n      overflow: visible;\n      padding: 3px;\n      box-sizing: border-box;\n    }\n    \n    .week-column {\n      display: flex;\n      flex-direction: column;\n      margin-right: ").concat(ye.cellMargin,"px;\n      width: ").concat(ye.cellWidth,"px;\n      flex-shrink: 0;\n      box-sizing: border-box;\n    }\n    \n    .day-cell {\n      width: var(--heatmap-cell-width);\n      height: var(--heatmap-cell-width);\n      margin-bottom: var(--heatmap-cell-margin);\n      border-radius: 2px;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      flex-shrink: 0;\n      position: relative;\n      box-sizing: border-box;\n    }\n    \n    .empty-cell {\n      width: ").concat(ye.cellWidth,"px;\n      height: ").concat(ye.cellWidth,"px;\n      margin-bottom: ").concat(ye.cellMargin,"px;\n      flex-shrink: 0;\n      box-sizing: border-box;\n    }\n    \n    /* Detail View Components */\n    .content-container {\n      display: flex;\n      flex-direction: column;\n      flex: 1;\n      padding-right: 4px;\n      overflow: hidden;\n    }\n    \n    .total-element {\n      margin-bottom: 4px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    .dominant-element {\n      margin-bottom: 12px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    .breakdown-container {\n      flex: 1;\n      overflow: hidden;\n      display: flex;\n      flex-direction: column;\n    }\n    \n    /* Breakdown Items */\n    .breakdown-item {\n      display: flex;\n      align-items: center;\n      margin-bottom: 4px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    \n    .color-swatch {\n      width: 12px;\n      height: 12px;\n      margin-right: 8px;\n      flex-shrink: 0;\n      border-radius: 2px;\n    }\n    \n    .game-name {\n      flex: 1;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 0;\n    }\n    \n    /* Responsive Styles */\n    @media (max-width: 500px) {\n      .card-content {\n        flex-direction: column;\n      }\n      \n      .heatmap-container {\n        padding-right: 16px;\n      }\n      \n      .detail-view {\n        max-width: none;\n        border-left: none;\n        border-top: 1px solid var(--divider-color, #CCC);\n      }\n    }\n\n    /* Improved hover and selection styles */\n    .day-cell:hover {\n      box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 33, 150, 243), 0.5);\n      z-index: 3;\n      transform: scale(1.05);\n    }\n\n    .day-cell.selected {\n      box-shadow: 0 0 0 3px var(--primary-color, #2196F3);\n      z-index: 4;\n      transform: scale(1.1);\n    }\n    \n    /* Fix for edge cells to prevent halo clipping */\n    .heatmap-grid-wrapper {\n      padding: 3px;\n      overflow: visible !important;\n      position: relative;\n      box-sizing: border-box;\n    }\n    \n    /* Specific styles for edge cells - using transform instead of margin to prevent alignment issues */\n    .day-cell.first-in-row,\n    .day-cell.last-in-row,\n    .day-cell.first-in-column,\n    .day-cell.last-in-column {\n      position: relative;\n      z-index: 2;\n    }\n    \n    /* New classes to replace inline styles */\n    .flex-container {\n      display: flex;\n    }\n    \n    .flex-align-stretch {\n      align-items: stretch;\n    }\n    \n    .flex-align-start {\n      align-items: flex-start;\n    }\n    \n    .flex-column {\n      flex-direction: column;\n    }\n    \n    .grid-container-spacing {\n      margin-top: 2px;\n    }\n    \n    .month-header-spacing {\n      margin-bottom: 2px;\n    }\n    \n    .day-label-spacing {\n      margin-right: 4px;\n    }\n    \n    .week-column-spacing {\n      margin-right: ").concat(ye.cellMargin,"px;\n    }\n    \n    .position-relative {\n      position: relative;\n    }\n  ")),o=document.createElement("style");o.textContent=a;var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"monday",n=new Date,i=new Date(n.getTime()-24*e*60*60*1e3),a=i.getDay();if("monday"===t){var o=0===a?6:a-1;i.setDate(i.getDate()-o)}else i.setDate(i.getDate()-a);return i}(this._config.days_to_show,this._config.start_day_of_week),l=function(e){for(var t=new Date,n=[],i=new Date(e);i<=t;){for(var a=[],o=0;o<7;o++)i<=t&&a.push(new Date(i)),i.setDate(i.getDate()+1);n.push(a)}return n}(r),c=function(e){var t=[],n=null;return e.forEach((e=>{var i=e[0],a=i.getMonth(),o=i.toLocaleString("default",{month:"short"});n?n.month===a?n.count++:(t.push(n),n={month:a,monthName:o,count:1}):n={month:a,monthName:o,count:1}})),n&&t.push(n),t}(l),d=ge("ha-card",{},{}),h=ge("div",{},{className:"card-content flex-container flex-align-stretch"}),p=ge("div",{},{className:"heatmap-container"}),u=ge("div",{},{className:"card-header",textContent:this._config.title||"Calendar Heatmap"});p.appendChild(u);var m=ge("div",{},{className:"detail-view"}),g=function(e){var{weekColWidth:t}=ye,n=ge("div",{},{className:"month-header month-header-spacing"}),i=0;return e.forEach((e=>{var a=e.count*t;i+=a;var o=ge("div",{},{className:"month-label",style:"width: ".concat(a,"px;"),textContent:e.monthName});n.appendChild(o)})),n.style.minWidth="".concat(i,"px"),n}(c,getComputedStyle(this));p.appendChild(g);var v=ge("div",{},{className:"grid-container flex-container flex-align-start grid-container-spacing"}),f=be(getComputedStyle(this),this._config.start_day_of_week);v.appendChild(f);var _=Math.min(l.length,52),y=l.slice(0,_),b=ge("div",{},{className:"heatmap-grid-wrapper position-relative"}),w=xe(y,this._dailyTotals,this._maxValue,this._gameColorMap,this._config.theme,(e=>this._onCellHover(e)),(e=>this._onCellClick(e)),this._selectedDate);b.appendChild(w),v.appendChild(b),p.appendChild(v),this._selectedDate?this._updateDetailView(this._selectedDate):this._updateDetailView(null),h.appendChild(p),h.appendChild(m),d.appendChild(h);var x=this.shadowRoot;return x.innerHTML="",x.appendChild(o),x.appendChild(d),setTimeout((()=>{this._selectedDate?this._updateDetailView(this._selectedDate):this._updateDetailView(null)}),0),B(_e||(_e=s([""])))}}),window.customCards=window.customCards||[],window.customCards.push({type:"calendar-heatmap-card",name:"Calendar Heatmap Card",description:"A calendar heatmap card for visualizing entity activity data",preview:!0,documentationURL:"https://github.com/MagicMicky/lovelace-calendar-heatmap-card"});
//# sourceMappingURL=calendar-heatmap-card.js.map
